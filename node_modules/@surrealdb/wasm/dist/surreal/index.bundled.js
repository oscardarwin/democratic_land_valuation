var Deno=globalThis.Deno??(typeof global>"u"?void 0:{readFile:(await import("node:fs")).readFileSync}),module=await(async()=>{let crypto2=globalThis.crypto??await import("node:crypto");return{require:string=>{if(string!=="crypto")throw new Error("Unexpected require "+string);return crypto2}}})(),heap=new Array(128).fill(void 0);heap.push(void 0,null,!0,!1);function getObject(idx){return heap[idx]}var WASM_VECTOR_LEN=0,cachedUint8ArrayMemory0=null;function getUint8ArrayMemory0(){return(cachedUint8ArrayMemory0===null||cachedUint8ArrayMemory0.byteLength===0)&&(cachedUint8ArrayMemory0=new Uint8Array(wasm.memory.buffer)),cachedUint8ArrayMemory0}var cachedTextEncoder=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},encodeString=function(arg,view){return cachedTextEncoder.encodeInto(arg,view)};function passStringToWasm0(arg,malloc,realloc){if(realloc===void 0){let buf=cachedTextEncoder.encode(arg),ptr2=malloc(buf.length,1)>>>0;return getUint8ArrayMemory0().subarray(ptr2,ptr2+buf.length).set(buf),WASM_VECTOR_LEN=buf.length,ptr2}let len=arg.length,ptr=malloc(len,1)>>>0,mem=getUint8ArrayMemory0(),offset=0;for(;offset<len;offset++){let code=arg.charCodeAt(offset);if(code>127)break;mem[ptr+offset]=code}if(offset!==len){offset!==0&&(arg=arg.slice(offset)),ptr=realloc(ptr,len,len=offset+arg.length*3,1)>>>0;let view=getUint8ArrayMemory0().subarray(ptr+offset,ptr+len),ret=encodeString(arg,view);offset+=ret.written,ptr=realloc(ptr,len,offset,1)>>>0}return WASM_VECTOR_LEN=offset,ptr}var cachedDataViewMemory0=null;function getDataViewMemory0(){return(cachedDataViewMemory0===null||cachedDataViewMemory0.buffer.detached===!0||cachedDataViewMemory0.buffer.detached===void 0&&cachedDataViewMemory0.buffer!==wasm.memory.buffer)&&(cachedDataViewMemory0=new DataView(wasm.memory.buffer)),cachedDataViewMemory0}var heap_next=heap.length;function addHeapObject(obj){heap_next===heap.length&&heap.push(heap.length+1);let idx=heap_next;return heap_next=heap[idx],heap[idx]=obj,idx}function handleError(f2,args){try{return f2.apply(this,args)}catch(e){wasm.__wbindgen_export_2(addHeapObject(e))}}var cachedTextDecoder=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&cachedTextDecoder.decode();function getStringFromWasm0(ptr,len){return ptr=ptr>>>0,cachedTextDecoder.decode(getUint8ArrayMemory0().subarray(ptr,ptr+len))}function isLikeNone(x){return x==null}function dropObject(idx){idx<132||(heap[idx]=heap_next,heap_next=idx)}function takeObject(idx){let ret=getObject(idx);return dropObject(idx),ret}var CLOSURE_DTORS=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(state=>{wasm.__wbindgen_export_4.get(state.dtor)(state.a,state.b)});function makeMutClosure(arg0,arg1,dtor,f2){let state={a:arg0,b:arg1,cnt:1,dtor},real=(...args)=>{state.cnt++;let a=state.a;state.a=0;try{return f2(a,state.b,...args)}finally{--state.cnt===0?(wasm.__wbindgen_export_4.get(state.dtor)(a,state.b),CLOSURE_DTORS.unregister(state)):state.a=a}};return real.original=state,CLOSURE_DTORS.register(real,state,state),real}function debugString(val){let type=typeof val;if(type=="number"||type=="boolean"||val==null)return`${val}`;if(type=="string")return`"${val}"`;if(type=="symbol"){let description=val.description;return description==null?"Symbol":`Symbol(${description})`}if(type=="function"){let name=val.name;return typeof name=="string"&&name.length>0?`Function(${name})`:"Function"}if(Array.isArray(val)){let length=val.length,debug="[";length>0&&(debug+=debugString(val[0]));for(let i=1;i<length;i++)debug+=", "+debugString(val[i]);return debug+="]",debug}let builtInMatches=/\[object ([^\]]+)\]/.exec(toString.call(val)),className;if(builtInMatches&&builtInMatches.length>1)className=builtInMatches[1];else return toString.call(val);if(className=="Object")try{return"Object("+JSON.stringify(val)+")"}catch{return"Object"}return val instanceof Error?`${val.name}: ${val.message}
${val.stack}`:className}function __wbg_adapter_52(arg0,arg1,arg2){try{let retptr=wasm.__wbindgen_add_to_stack_pointer(-16);wasm.__wbindgen_export_5(retptr,arg0,arg1,addHeapObject(arg2));var r0=getDataViewMemory0().getInt32(retptr+4*0,!0),r1=getDataViewMemory0().getInt32(retptr+4*1,!0);if(r1)throw takeObject(r0)}finally{wasm.__wbindgen_add_to_stack_pointer(16)}}function __wbg_adapter_55(arg0,arg1){wasm.__wbindgen_export_6(arg0,arg1)}function __wbg_adapter_58(arg0,arg1,arg2){wasm.__wbindgen_export_7(arg0,arg1,addHeapObject(arg2))}function __wbg_adapter_325(arg0,arg1,arg2,arg3){wasm.__wbindgen_export_8(arg0,arg1,addHeapObject(arg2),addHeapObject(arg3))}var __wbindgen_enum_IdbCursorDirection=["next","nextunique","prev","prevunique"],__wbindgen_enum_IdbTransactionMode=["readonly","readwrite","versionchange","readwriteflush","cleanup"];var __wbindgen_enum_RequestCredentials=["omit","same-origin","include"],__wbindgen_enum_RequestMode=["same-origin","no-cors","cors","navigate"],IntoUnderlyingByteSourceFinalization=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(ptr=>wasm.__wbg_intounderlyingbytesource_free(ptr>>>0,1));var IntoUnderlyingSinkFinalization=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(ptr=>wasm.__wbg_intounderlyingsink_free(ptr>>>0,1));var IntoUnderlyingSourceFinalization=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(ptr=>wasm.__wbg_intounderlyingsource_free(ptr>>>0,1)),IntoUnderlyingSource=class{static __wrap(ptr){ptr=ptr>>>0;let obj=Object.create(IntoUnderlyingSource.prototype);return obj.__wbg_ptr=ptr,IntoUnderlyingSourceFinalization.register(obj,obj.__wbg_ptr,obj),obj}__destroy_into_raw(){let ptr=this.__wbg_ptr;return this.__wbg_ptr=0,IntoUnderlyingSourceFinalization.unregister(this),ptr}free(){let ptr=this.__destroy_into_raw();wasm.__wbg_intounderlyingsource_free(ptr,0)}pull(controller){let ret=wasm.intounderlyingsource_pull(this.__wbg_ptr,addHeapObject(controller));return takeObject(ret)}cancel(){let ptr=this.__destroy_into_raw();wasm.intounderlyingsource_cancel(ptr)}},SurrealWasmEngineFinalization=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(ptr=>wasm.__wbg_surrealwasmengine_free(ptr>>>0,1)),SurrealWasmEngine=class{static __wrap(ptr){ptr=ptr>>>0;let obj=Object.create(SurrealWasmEngine.prototype);return obj.__wbg_ptr=ptr,SurrealWasmEngineFinalization.register(obj,obj.__wbg_ptr,obj),obj}__destroy_into_raw(){let ptr=this.__wbg_ptr;return this.__wbg_ptr=0,SurrealWasmEngineFinalization.unregister(this),ptr}free(){let ptr=this.__destroy_into_raw();wasm.__wbg_surrealwasmengine_free(ptr,0)}execute(data){let ret=wasm.surrealwasmengine_execute(this.__wbg_ptr,addHeapObject(data));return takeObject(ret)}notifications(){try{let retptr=wasm.__wbindgen_add_to_stack_pointer(-16);wasm.surrealwasmengine_notifications(retptr,this.__wbg_ptr);var r0=getDataViewMemory0().getInt32(retptr+4*0,!0),r1=getDataViewMemory0().getInt32(retptr+4*1,!0),r2=getDataViewMemory0().getInt32(retptr+4*2,!0);if(r2)throw takeObject(r1);return takeObject(r0)}finally{wasm.__wbindgen_add_to_stack_pointer(16)}}static connect(endpoint,opts){let ptr0=passStringToWasm0(endpoint,wasm.__wbindgen_export_0,wasm.__wbindgen_export_1),len0=WASM_VECTOR_LEN,ret=wasm.surrealwasmengine_connect(ptr0,len0,isLikeNone(opts)?0:addHeapObject(opts));return takeObject(ret)}export(config){let ret=wasm.surrealwasmengine_export(this.__wbg_ptr,isLikeNone(config)?0:addHeapObject(config));return takeObject(ret)}import(input){let ptr0=passStringToWasm0(input,wasm.__wbindgen_export_0,wasm.__wbindgen_export_1),len0=WASM_VECTOR_LEN,ret=wasm.surrealwasmengine_import(this.__wbg_ptr,ptr0,len0);return takeObject(ret)}static version(){let deferred2_0,deferred2_1;try{let retptr=wasm.__wbindgen_add_to_stack_pointer(-16);wasm.surrealwasmengine_version(retptr);var r0=getDataViewMemory0().getInt32(retptr+4*0,!0),r1=getDataViewMemory0().getInt32(retptr+4*1,!0),r2=getDataViewMemory0().getInt32(retptr+4*2,!0),r3=getDataViewMemory0().getInt32(retptr+4*3,!0),ptr1=r0,len1=r1;if(r3)throw ptr1=0,len1=0,takeObject(r2);return deferred2_0=ptr1,deferred2_1=len1,getStringFromWasm0(ptr1,len1)}finally{wasm.__wbindgen_add_to_stack_pointer(16),wasm.__wbindgen_export_3(deferred2_0,deferred2_1,1)}}},imports={__wbindgen_placeholder__:{__wbg_String_8f0eb39a4a4c2f66:function(arg0,arg1){let ret=String(getObject(arg1)),ptr1=passStringToWasm0(ret,wasm.__wbindgen_export_0,wasm.__wbindgen_export_1),len1=WASM_VECTOR_LEN;getDataViewMemory0().setInt32(arg0+4*1,len1,!0),getDataViewMemory0().setInt32(arg0+4*0,ptr1,!0)},__wbg_abort_7b156f9a934692c8:function(){return handleError(function(arg0){getObject(arg0).abort()},arguments)},__wbg_abort_8d4ada33948fb9ea:function(arg0){getObject(arg0).abort()},__wbg_advance_abb49821a3fbd03f:function(){return handleError(function(arg0,arg1){getObject(arg0).advance(arg1>>>0)},arguments)},__wbg_append_3e87a8957446cdbe:function(){return handleError(function(arg0,arg1,arg2,arg3){getObject(arg0).append(getStringFromWasm0(arg1,arg2),getObject(arg3))},arguments)},__wbg_append_606491fde95f39dd:function(){return handleError(function(arg0,arg1,arg2,arg3,arg4,arg5){getObject(arg0).append(getStringFromWasm0(arg1,arg2),getObject(arg3),getStringFromWasm0(arg4,arg5))},arguments)},__wbg_append_7d0ec8d7eeb807f8:function(){return handleError(function(arg0,arg1,arg2,arg3,arg4){getObject(arg0).append(getStringFromWasm0(arg1,arg2),getStringFromWasm0(arg3,arg4))},arguments)},__wbg_append_8a69fec038be9b14:function(){return handleError(function(arg0,arg1,arg2,arg3,arg4){getObject(arg0).append(getStringFromWasm0(arg1,arg2),getStringFromWasm0(arg3,arg4))},arguments)},__wbg_arrayBuffer_244b9be4ec34cae8:function(){return handleError(function(arg0){let ret=getObject(arg0).arrayBuffer();return addHeapObject(ret)},arguments)},__wbg_bound_4f1813f8f3e3f9d9:function(){return handleError(function(arg0,arg1,arg2,arg3){let ret=IDBKeyRange.bound(getObject(arg0),getObject(arg1),arg2!==0,arg3!==0);return addHeapObject(ret)},arguments)},__wbg_buffer_09165b52af8c5237:function(arg0){let ret=getObject(arg0).buffer;return addHeapObject(ret)},__wbg_buffer_609cc3eee51ed158:function(arg0){let ret=getObject(arg0).buffer;return addHeapObject(ret)},__wbg_byobRequest_9dd6d13eb365e223:function(arg0){let ret=getObject(arg0).byobRequest;return isLikeNone(ret)?0:addHeapObject(ret)},__wbg_byteLength_e674b853d9c77e1d:function(arg0){return getObject(arg0).byteLength},__wbg_byteOffset_fd862df290ef848d:function(arg0){return getObject(arg0).byteOffset},__wbg_call_672a4d21634d4a24:function(){return handleError(function(arg0,arg1){let ret=getObject(arg0).call(getObject(arg1));return addHeapObject(ret)},arguments)},__wbg_call_7cccdd69e0791ae2:function(){return handleError(function(arg0,arg1,arg2){let ret=getObject(arg0).call(getObject(arg1),getObject(arg2));return addHeapObject(ret)},arguments)},__wbg_close_2c98beee2b59af63:function(){return handleError(function(arg0){getObject(arg0).close()},arguments)},__wbg_close_f825000f2241f096:function(){return handleError(function(arg0){getObject(arg0).close()},arguments)},__wbg_contains_937335f901da551e:function(arg0,arg1,arg2){return getObject(arg0).contains(getStringFromWasm0(arg1,arg2))},__wbg_continue_27b71757c0c4fea9:function(){return handleError(function(arg0){getObject(arg0).continue()},arguments)},__wbg_createIndex_27f2cac51a4cd52d:function(){return handleError(function(arg0,arg1,arg2,arg3,arg4){let ret=getObject(arg0).createIndex(getStringFromWasm0(arg1,arg2),getObject(arg3),getObject(arg4));return addHeapObject(ret)},arguments)},__wbg_createObjectStore_6c362cb985544591:function(){return handleError(function(arg0,arg1,arg2,arg3){let ret=getObject(arg0).createObjectStore(getStringFromWasm0(arg1,arg2),getObject(arg3));return addHeapObject(ret)},arguments)},__wbg_crypto_ed58b8e10a292839:function(arg0){let ret=getObject(arg0).crypto;return addHeapObject(ret)},__wbg_deleteIndex_3cbe58a8d944e296:function(){return handleError(function(arg0,arg1,arg2){getObject(arg0).deleteIndex(getStringFromWasm0(arg1,arg2))},arguments)},__wbg_deleteObjectStore_20a09699039e66cf:function(){return handleError(function(arg0,arg1,arg2){getObject(arg0).deleteObjectStore(getStringFromWasm0(arg1,arg2))},arguments)},__wbg_delete_53dfb3f8054be6d4:function(){return handleError(function(arg0,arg1){let ret=getObject(arg0).delete(getObject(arg1));return addHeapObject(ret)},arguments)},__wbg_done_769e5ede4b31c67b:function(arg0){return getObject(arg0).done},__wbg_enqueue_8a48484465436b3b:function(){return handleError(function(arg0,arg1){getObject(arg0).enqueue(getObject(arg1))},arguments)},__wbg_entries_3265d4158b33e5dc:function(arg0){let ret=Object.entries(getObject(arg0));return addHeapObject(ret)},__wbg_error_3230f94bfce7b80b:function(){return handleError(function(arg0){let ret=getObject(arg0).error;return isLikeNone(ret)?0:addHeapObject(ret)},arguments)},__wbg_error_7534b8e9a36f1ab4:function(arg0,arg1){let deferred0_0,deferred0_1;try{deferred0_0=arg0,deferred0_1=arg1,console.error(getStringFromWasm0(arg0,arg1))}finally{wasm.__wbindgen_export_3(deferred0_0,deferred0_1,1)}},__wbg_fetch_b335d17f45a8b5a1:function(arg0){let ret=fetch(getObject(arg0));return addHeapObject(ret)},__wbg_fetch_f649bd7134840205:function(arg0,arg1){let ret=getObject(arg0).fetch(getObject(arg1));return addHeapObject(ret)},__wbg_getRandomValues_bcb4912f16000dc4:function(){return handleError(function(arg0,arg1){getObject(arg0).getRandomValues(getObject(arg1))},arguments)},__wbg_getTime_46267b1c24877e30:function(arg0){return getObject(arg0).getTime()},__wbg_getTimezoneOffset_6b5752021c499c47:function(arg0){return getObject(arg0).getTimezoneOffset()},__wbg_get_03362f1d791e71b4:function(arg0,arg1,arg2){let ret=getObject(arg1)[arg2>>>0];var ptr1=isLikeNone(ret)?0:passStringToWasm0(ret,wasm.__wbindgen_export_0,wasm.__wbindgen_export_1),len1=WASM_VECTOR_LEN;getDataViewMemory0().setInt32(arg0+4*1,len1,!0),getDataViewMemory0().setInt32(arg0+4*0,ptr1,!0)},__wbg_get_67b2ba62fc30de12:function(){return handleError(function(arg0,arg1){let ret=Reflect.get(getObject(arg0),getObject(arg1));return addHeapObject(ret)},arguments)},__wbg_get_b9b93047fe3cf45b:function(arg0,arg1){let ret=getObject(arg0)[arg1>>>0];return addHeapObject(ret)},__wbg_get_cb402296cc90b202:function(){return handleError(function(arg0,arg1){let ret=getObject(arg0).get(getObject(arg1));return addHeapObject(ret)},arguments)},__wbg_getwithrefkey_1dc361bd10053bfe:function(arg0,arg1){let ret=getObject(arg0)[getObject(arg1)];return addHeapObject(ret)},__wbg_has_a5ea9117f258a0ec:function(){return handleError(function(arg0,arg1){return Reflect.has(getObject(arg0),getObject(arg1))},arguments)},__wbg_headers_cc3fc3b432f8aabc:function(arg0){let ret=getObject(arg0).headers;return addHeapObject(ret)},__wbg_indexNames_e6b5af4de19535f9:function(arg0){let ret=getObject(arg0).indexNames;return addHeapObject(ret)},__wbg_instanceof_ArrayBuffer_e14585432e3737fc:function(arg0){let result;try{result=getObject(arg0)instanceof ArrayBuffer}catch{result=!1}return result},__wbg_instanceof_IdbFactory_208c69fb742144ef:function(arg0){let result;try{result=getObject(arg0)instanceof IDBFactory}catch{result=!1}return result},__wbg_instanceof_Map_f3469ce2244d2430:function(arg0){let result;try{result=getObject(arg0)instanceof Map}catch{result=!1}return result},__wbg_instanceof_Response_d1b3f08d4983dc43:function(arg0){let result;try{result=getObject(arg0)instanceof Response}catch{result=!1}return result},__wbg_instanceof_Uint8Array_17156bcf118086a9:function(arg0){let result;try{result=getObject(arg0)instanceof Uint8Array}catch{result=!1}return result},__wbg_isArray_a1eab7e0d067391b:function(arg0){return Array.isArray(getObject(arg0))},__wbg_isSafeInteger_343e2beeeece1bb0:function(arg0){return Number.isSafeInteger(getObject(arg0))},__wbg_iterator_9a24c88df860dc65:function(){return addHeapObject(Symbol.iterator)},__wbg_key_c1ce61ee9fe74d5e:function(){return handleError(function(arg0){let ret=getObject(arg0).key;return addHeapObject(ret)},arguments)},__wbg_length_3d288388f4eff153:function(arg0){return getObject(arg0).length},__wbg_length_a446193dc22c12f8:function(arg0){return getObject(arg0).length},__wbg_length_e2d2a49132c1b256:function(arg0){return getObject(arg0).length},__wbg_msCrypto_0a36e2ec3a343d26:function(arg0){let ret=getObject(arg0).msCrypto;return addHeapObject(ret)},__wbg_new0_f788a2397c7ca929:function(){return addHeapObject(new Date)},__wbg_new_23a2665fac83c611:function(arg0,arg1){try{var state0={a:arg0,b:arg1},cb0=(arg02,arg12)=>{let a=state0.a;state0.a=0;try{return __wbg_adapter_325(a,state0.b,arg02,arg12)}finally{state0.a=a}};let ret=new Promise(cb0);return addHeapObject(ret)}finally{state0.a=state0.b=0}},__wbg_new_30ce8fc18ad7d74d:function(){return handleError(function(){let ret=new FormData;return addHeapObject(ret)},arguments)},__wbg_new_31a97dac4f10fab7:function(arg0){let ret=new Date(getObject(arg0));return addHeapObject(ret)},__wbg_new_3955c5041f5c225a:function(){return handleError(function(){let ret=new AbortController;return addHeapObject(ret)},arguments)},__wbg_new_405e22f390576ce2:function(){let ret=new Object;return addHeapObject(ret)},__wbg_new_78feb108b6472713:function(){let ret=new Array;return addHeapObject(ret)},__wbg_new_8a6f238a6ece86ea:function(){let ret=new Error;return addHeapObject(ret)},__wbg_new_9d9027fccb1f4cb1:function(){return handleError(function(){let ret=new Headers;return addHeapObject(ret)},arguments)},__wbg_new_a12002a7f91c75be:function(arg0){let ret=new Uint8Array(getObject(arg0));return addHeapObject(ret)},__wbg_new_c68d7209be747379:function(arg0,arg1){let ret=new Error(getStringFromWasm0(arg0,arg1));return addHeapObject(ret)},__wbg_newnoargs_105ed471475aaf50:function(arg0,arg1){let ret=new Function(getStringFromWasm0(arg0,arg1));return addHeapObject(ret)},__wbg_newwithbyteoffsetandlength_d97e637ebe145a9a:function(arg0,arg1,arg2){let ret=new Uint8Array(getObject(arg0),arg1>>>0,arg2>>>0);return addHeapObject(ret)},__wbg_newwithintounderlyingsource_b47f6a6a596a7f24:function(arg0,arg1){let ret=new ReadableStream(IntoUnderlyingSource.__wrap(arg0),takeObject(arg1));return addHeapObject(ret)},__wbg_newwithlength_a381634e90c276d4:function(arg0){let ret=new Uint8Array(arg0>>>0);return addHeapObject(ret)},__wbg_newwithstrandinit_80f4e7be678ad35c:function(){return handleError(function(arg0,arg1,arg2){let ret=new Request(getStringFromWasm0(arg0,arg1),getObject(arg2));return addHeapObject(ret)},arguments)},__wbg_newwithu8arraysequenceandoptions_d9b305a9018c69af:function(){return handleError(function(arg0,arg1){let ret=new Blob(getObject(arg0),getObject(arg1));return addHeapObject(ret)},arguments)},__wbg_next_25feadfc0913fea9:function(arg0){let ret=getObject(arg0).next;return addHeapObject(ret)},__wbg_next_6574e1a8a62d1055:function(){return handleError(function(arg0){let ret=getObject(arg0).next();return addHeapObject(ret)},arguments)},__wbg_node_02999533c4ea02e3:function(arg0){let ret=getObject(arg0).node;return addHeapObject(ret)},__wbg_now_0aa56f09925b8a32:function(){return handleError(function(){return Date.now()},arguments)},__wbg_now_71123b9940376874:function(arg0){return getObject(arg0).now()},__wbg_now_807e54c39636c349:function(){return Date.now()},__wbg_now_b0b7c9b615d4d2b0:function(arg0){return getObject(arg0).now()},__wbg_objectStoreNames_a8eac7ac7196dd15:function(arg0){let ret=getObject(arg0).objectStoreNames;return addHeapObject(ret)},__wbg_objectStore_ce40908bf9e57302:function(){return handleError(function(arg0,arg1,arg2){let ret=getObject(arg0).objectStore(getStringFromWasm0(arg1,arg2));return addHeapObject(ret)},arguments)},__wbg_openCursor_3b0ef3db8f40f9e7:function(){return handleError(function(arg0){let ret=getObject(arg0).openCursor();return addHeapObject(ret)},arguments)},__wbg_openCursor_44559a0768aec010:function(){return handleError(function(arg0,arg1){let ret=getObject(arg0).openCursor(getObject(arg1));return addHeapObject(ret)},arguments)},__wbg_openCursor_ac3d0ce5dc7d2123:function(){return handleError(function(arg0,arg1,arg2){let ret=getObject(arg0).openCursor(getObject(arg1),__wbindgen_enum_IdbCursorDirection[arg2]);return addHeapObject(ret)},arguments)},__wbg_open_d146cc6a7ba27ec9:function(){return handleError(function(arg0,arg1,arg2){let ret=getObject(arg0).open(getStringFromWasm0(arg1,arg2));return addHeapObject(ret)},arguments)},__wbg_open_f7b389eba1c71f1b:function(){return handleError(function(arg0,arg1,arg2,arg3){let ret=getObject(arg0).open(getStringFromWasm0(arg1,arg2),arg3>>>0);return addHeapObject(ret)},arguments)},__wbg_performance_1a2515c93daf8b0c:function(arg0){let ret=getObject(arg0).performance;return addHeapObject(ret)},__wbg_process_5c1d670bc53614b8:function(arg0){let ret=getObject(arg0).process;return addHeapObject(ret)},__wbg_push_737cfc8c1432c2c6:function(arg0,arg1){return getObject(arg0).push(getObject(arg1))},__wbg_put_01597a848258405e:function(){return handleError(function(arg0,arg1){let ret=getObject(arg0).put(getObject(arg1));return addHeapObject(ret)},arguments)},__wbg_put_aabe694fbd34ced8:function(){return handleError(function(arg0,arg1,arg2){let ret=getObject(arg0).put(getObject(arg1),getObject(arg2));return addHeapObject(ret)},arguments)},__wbg_queueMicrotask_5a8a9131f3f0b37b:function(arg0){let ret=getObject(arg0).queueMicrotask;return addHeapObject(ret)},__wbg_queueMicrotask_6d79674585219521:function(arg0){queueMicrotask(getObject(arg0))},__wbg_randomFillSync_ab2cfe79ebbf2740:function(){return handleError(function(arg0,arg1){getObject(arg0).randomFillSync(takeObject(arg1))},arguments)},__wbg_require_79b1e9274cde3c87:function(){return handleError(function(){let ret=module.require;return addHeapObject(ret)},arguments)},__wbg_resolve_4851785c9c5f573d:function(arg0){let ret=Promise.resolve(getObject(arg0));return addHeapObject(ret)},__wbg_respond_442db8b929a98e76:function(){return handleError(function(arg0,arg1){getObject(arg0).respond(arg1>>>0)},arguments)},__wbg_result_f57debd007c5c104:function(){return handleError(function(arg0){let ret=getObject(arg0).result;return addHeapObject(ret)},arguments)},__wbg_setTimeout_efd7c11531df1743:function(){return handleError(function(arg0,arg1,arg2){return getObject(arg0).setTimeout(getObject(arg1),arg2)},arguments)},__wbg_set_65595bdd868b3009:function(arg0,arg1,arg2){getObject(arg0).set(getObject(arg1),arg2>>>0)},__wbg_setautoincrement_fcd31f31fea8c82f:function(arg0,arg1){getObject(arg0).autoIncrement=arg1!==0},__wbg_setbody_e622304a359e9997:function(arg0,arg1){getObject(arg0).body=getObject(arg1)},__wbg_setcredentials_6c1850c906a4c7d8:function(arg0,arg1){getObject(arg0).credentials=__wbindgen_enum_RequestCredentials[arg1]},__wbg_setheaders_37c4507b6650184a:function(arg0,arg1){getObject(arg0).headers=getObject(arg1)},__wbg_sethighwatermark_64ea7c426148c185:function(arg0,arg1){getObject(arg0).highWaterMark=arg1},__wbg_setkeypath_1e16c30180605f46:function(arg0,arg1){getObject(arg0).keyPath=getObject(arg1)},__wbg_setmethod_20004624d0bb3c04:function(arg0,arg1,arg2){getObject(arg0).method=getStringFromWasm0(arg1,arg2)},__wbg_setmode_cfeb23c22a98ee10:function(arg0,arg1){getObject(arg0).mode=__wbindgen_enum_RequestMode[arg1]},__wbg_setmultientry_f3a5a9f19e492f6a:function(arg0,arg1){getObject(arg0).multiEntry=arg1!==0},__wbg_setonabort_d9f829d871ee7eef:function(arg0,arg1){getObject(arg0).onabort=getObject(arg1)},__wbg_setoncomplete_9804afe8f5f9b7f3:function(arg0,arg1){getObject(arg0).oncomplete=getObject(arg1)},__wbg_setonerror_856be821d2e2bb16:function(arg0,arg1){getObject(arg0).onerror=getObject(arg1)},__wbg_setonerror_e69e5108aa7e5147:function(arg0,arg1){getObject(arg0).onerror=getObject(arg1)},__wbg_setonsuccess_2bf90c1449edce2a:function(arg0,arg1){getObject(arg0).onsuccess=getObject(arg1)},__wbg_setonupgradeneeded_d3692b955a1d8d06:function(arg0,arg1){getObject(arg0).onupgradeneeded=getObject(arg1)},__wbg_setsignal_1c7fc807a0404525:function(arg0,arg1){getObject(arg0).signal=getObject(arg1)},__wbg_settype_8bac22cb8a404937:function(arg0,arg1,arg2){getObject(arg0).type=getStringFromWasm0(arg1,arg2)},__wbg_setunique_029a53d2d65b2ed9:function(arg0,arg1){getObject(arg0).unique=arg1!==0},__wbg_signal_05cd9a8401da1904:function(arg0){let ret=getObject(arg0).signal;return addHeapObject(ret)},__wbg_stack_0ed75d68575b0f3c:function(arg0,arg1){let ret=getObject(arg1).stack,ptr1=passStringToWasm0(ret,wasm.__wbindgen_export_0,wasm.__wbindgen_export_1),len1=WASM_VECTOR_LEN;getDataViewMemory0().setInt32(arg0+4*1,len1,!0),getDataViewMemory0().setInt32(arg0+4*0,ptr1,!0)},__wbg_static_accessor_GLOBAL_88a902d13a557d07:function(){let ret=typeof global>"u"?null:global;return isLikeNone(ret)?0:addHeapObject(ret)},__wbg_static_accessor_GLOBAL_THIS_56578be7e9f832b0:function(){let ret=typeof globalThis>"u"?null:globalThis;return isLikeNone(ret)?0:addHeapObject(ret)},__wbg_static_accessor_SELF_37c5d418e4bf5819:function(){let ret=typeof self>"u"?null:self;return isLikeNone(ret)?0:addHeapObject(ret)},__wbg_static_accessor_WINDOW_5de37043a91a9c40:function(){let ret=typeof window>"u"?null:window;return isLikeNone(ret)?0:addHeapObject(ret)},__wbg_status_0469c5287b59ffc5:function(arg0){return getObject(arg0).status},__wbg_stringify_f7ed6987935b4a24:function(){return handleError(function(arg0){let ret=JSON.stringify(getObject(arg0));return addHeapObject(ret)},arguments)},__wbg_subarray_aa9065fa9dc5df96:function(arg0,arg1,arg2){let ret=getObject(arg0).subarray(arg1>>>0,arg2>>>0);return addHeapObject(ret)},__wbg_surrealwasmengine_new:function(arg0){let ret=SurrealWasmEngine.__wrap(arg0);return addHeapObject(ret)},__wbg_target_09f5f9412d4021c1:function(arg0){let ret=getObject(arg0).target;return isLikeNone(ret)?0:addHeapObject(ret)},__wbg_text_9847c497903c7989:function(){return handleError(function(arg0){let ret=getObject(arg0).text();return addHeapObject(ret)},arguments)},__wbg_then_44b73946d2fb3e7d:function(arg0,arg1){let ret=getObject(arg0).then(getObject(arg1));return addHeapObject(ret)},__wbg_then_48b406749878a531:function(arg0,arg1,arg2){let ret=getObject(arg0).then(getObject(arg1),getObject(arg2));return addHeapObject(ret)},__wbg_toString_c813bbd34d063839:function(arg0){let ret=getObject(arg0).toString();return addHeapObject(ret)},__wbg_transaction_52c74f7489f1381e:function(arg0){let ret=getObject(arg0).transaction;return isLikeNone(ret)?0:addHeapObject(ret)},__wbg_transaction_9d14aa9948a64b0d:function(){return handleError(function(arg0,arg1,arg2){let ret=getObject(arg0).transaction(getObject(arg1),__wbindgen_enum_IdbTransactionMode[arg2]);return addHeapObject(ret)},arguments)},__wbg_url_0f5a9de9ca05e0eb:function(arg0,arg1){let ret=getObject(arg1).url,ptr1=passStringToWasm0(ret,wasm.__wbindgen_export_0,wasm.__wbindgen_export_1),len1=WASM_VECTOR_LEN;getDataViewMemory0().setInt32(arg0+4*1,len1,!0),getDataViewMemory0().setInt32(arg0+4*0,ptr1,!0)},__wbg_value_aa2b46e3a9c92b9e:function(){return handleError(function(arg0){let ret=getObject(arg0).value;return addHeapObject(ret)},arguments)},__wbg_value_cd1ffa7b1ab794f1:function(arg0){let ret=getObject(arg0).value;return addHeapObject(ret)},__wbg_versions_c71aa1626a93e0a1:function(arg0){let ret=getObject(arg0).versions;return addHeapObject(ret)},__wbg_view_f0ef1c95fdf68f4a:function(arg0){let ret=getObject(arg0).view;return isLikeNone(ret)?0:addHeapObject(ret)},__wbindgen_as_number:function(arg0){return+getObject(arg0)},__wbindgen_bigint_from_i64:function(arg0){return addHeapObject(arg0)},__wbindgen_bigint_from_u64:function(arg0){let ret=BigInt.asUintN(64,arg0);return addHeapObject(ret)},__wbindgen_bigint_get_as_i64:function(arg0,arg1){let v=getObject(arg1),ret=typeof v=="bigint"?v:void 0;getDataViewMemory0().setBigInt64(arg0+8*1,isLikeNone(ret)?BigInt(0):ret,!0),getDataViewMemory0().setInt32(arg0+4*0,!isLikeNone(ret),!0)},__wbindgen_boolean_get:function(arg0){let v=getObject(arg0);return typeof v=="boolean"?v?1:0:2},__wbindgen_cb_drop:function(arg0){let obj=takeObject(arg0).original;return obj.cnt--==1?(obj.a=0,!0):!1},__wbindgen_closure_wrapper24440:function(arg0,arg1,arg2){let ret=makeMutClosure(arg0,arg1,1950,__wbg_adapter_52);return addHeapObject(ret)},__wbindgen_closure_wrapper26390:function(arg0,arg1,arg2){let ret=makeMutClosure(arg0,arg1,2182,__wbg_adapter_55);return addHeapObject(ret)},__wbindgen_closure_wrapper31226:function(arg0,arg1,arg2){let ret=makeMutClosure(arg0,arg1,2733,__wbg_adapter_58);return addHeapObject(ret)},__wbindgen_debug_string:function(arg0,arg1){let ret=debugString(getObject(arg1)),ptr1=passStringToWasm0(ret,wasm.__wbindgen_export_0,wasm.__wbindgen_export_1),len1=WASM_VECTOR_LEN;getDataViewMemory0().setInt32(arg0+4*1,len1,!0),getDataViewMemory0().setInt32(arg0+4*0,ptr1,!0)},__wbindgen_error_new:function(arg0,arg1){let ret=new Error(getStringFromWasm0(arg0,arg1));return addHeapObject(ret)},__wbindgen_in:function(arg0,arg1){return getObject(arg0)in getObject(arg1)},__wbindgen_is_bigint:function(arg0){return typeof getObject(arg0)=="bigint"},__wbindgen_is_falsy:function(arg0){return!getObject(arg0)},__wbindgen_is_function:function(arg0){return typeof getObject(arg0)=="function"},__wbindgen_is_object:function(arg0){let val=getObject(arg0);return typeof val=="object"&&val!==null},__wbindgen_is_string:function(arg0){return typeof getObject(arg0)=="string"},__wbindgen_is_undefined:function(arg0){return getObject(arg0)===void 0},__wbindgen_jsval_eq:function(arg0,arg1){return getObject(arg0)===getObject(arg1)},__wbindgen_jsval_loose_eq:function(arg0,arg1){return getObject(arg0)==getObject(arg1)},__wbindgen_memory:function(){let ret=wasm.memory;return addHeapObject(ret)},__wbindgen_number_get:function(arg0,arg1){let obj=getObject(arg1),ret=typeof obj=="number"?obj:void 0;getDataViewMemory0().setFloat64(arg0+8*1,isLikeNone(ret)?0:ret,!0),getDataViewMemory0().setInt32(arg0+4*0,!isLikeNone(ret),!0)},__wbindgen_number_new:function(arg0){return addHeapObject(arg0)},__wbindgen_object_clone_ref:function(arg0){let ret=getObject(arg0);return addHeapObject(ret)},__wbindgen_object_drop_ref:function(arg0){takeObject(arg0)},__wbindgen_string_get:function(arg0,arg1){let obj=getObject(arg1),ret=typeof obj=="string"?obj:void 0;var ptr1=isLikeNone(ret)?0:passStringToWasm0(ret,wasm.__wbindgen_export_0,wasm.__wbindgen_export_1),len1=WASM_VECTOR_LEN;getDataViewMemory0().setInt32(arg0+4*1,len1,!0),getDataViewMemory0().setInt32(arg0+4*0,ptr1,!0)},__wbindgen_string_new:function(arg0,arg1){let ret=getStringFromWasm0(arg0,arg1);return addHeapObject(ret)},__wbindgen_throw:function(arg0,arg1){throw new Error(getStringFromWasm0(arg0,arg1))}}},wasm_url=new URL("index_bg.wasm",import.meta.url),wasmCode="";switch(wasm_url.protocol){case"file:":wasmCode=await Deno.readFile(wasm_url);break;default:wasmCode=await(await fetch(wasm_url)).arrayBuffer();break}var wasmInstance=(await WebAssembly.instantiate(wasmCode,imports)).instance,wasm=wasmInstance.exports;var DIGITS="0123456789abcdef",UUID=class{constructor(bytes){this.bytes=bytes}static ofInner(bytes){if(bytes.length!==16)throw new TypeError("not 128-bit length");return new UUID(bytes)}static fromFieldsV7(unixTsMs,randA,randBHi,randBLo){if(!Number.isInteger(unixTsMs)||!Number.isInteger(randA)||!Number.isInteger(randBHi)||!Number.isInteger(randBLo)||unixTsMs<0||randA<0||randBHi<0||randBLo<0||unixTsMs>0xffffffffffff||randA>4095||randBHi>1073741823||randBLo>4294967295)throw new RangeError("invalid field value");let bytes=new Uint8Array(16);return bytes[0]=unixTsMs/2**40,bytes[1]=unixTsMs/2**32,bytes[2]=unixTsMs/2**24,bytes[3]=unixTsMs/2**16,bytes[4]=unixTsMs/2**8,bytes[5]=unixTsMs,bytes[6]=112|randA>>>8,bytes[7]=randA,bytes[8]=128|randBHi>>>24,bytes[9]=randBHi>>>16,bytes[10]=randBHi>>>8,bytes[11]=randBHi,bytes[12]=randBLo>>>24,bytes[13]=randBLo>>>16,bytes[14]=randBLo>>>8,bytes[15]=randBLo,new UUID(bytes)}static parse(uuid){var _a,_b,_c,_d;let hex;switch(uuid.length){case 32:hex=(_a=/^[0-9a-f]{32}$/i.exec(uuid))===null||_a===void 0?void 0:_a[0];break;case 36:hex=(_b=/^([0-9a-f]{8})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{12})$/i.exec(uuid))===null||_b===void 0?void 0:_b.slice(1,6).join("");break;case 38:hex=(_c=/^\{([0-9a-f]{8})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{12})\}$/i.exec(uuid))===null||_c===void 0?void 0:_c.slice(1,6).join("");break;case 45:hex=(_d=/^urn:uuid:([0-9a-f]{8})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{12})$/i.exec(uuid))===null||_d===void 0?void 0:_d.slice(1,6).join("");break;default:break}if(hex){let inner=new Uint8Array(16);for(let i=0;i<16;i+=4){let n=parseInt(hex.substring(2*i,2*i+8),16);inner[i+0]=n>>>24,inner[i+1]=n>>>16,inner[i+2]=n>>>8,inner[i+3]=n}return new UUID(inner)}else throw new SyntaxError("could not parse UUID string")}toString(){let text="";for(let i=0;i<this.bytes.length;i++)text+=DIGITS.charAt(this.bytes[i]>>>4),text+=DIGITS.charAt(this.bytes[i]&15),(i===3||i===5||i===7||i===9)&&(text+="-");return text}toHex(){let text="";for(let i=0;i<this.bytes.length;i++)text+=DIGITS.charAt(this.bytes[i]>>>4),text+=DIGITS.charAt(this.bytes[i]&15);return text}toJSON(){return this.toString()}getVariant(){let n=this.bytes[8]>>>4;if(n<0)throw new Error("unreachable");if(n<=7)return this.bytes.every(e=>e===0)?"NIL":"VAR_0";if(n<=11)return"VAR_10";if(n<=13)return"VAR_110";if(n<=15)return this.bytes.every(e=>e===255)?"MAX":"VAR_RESERVED";throw new Error("unreachable")}getVersion(){return this.getVariant()==="VAR_10"?this.bytes[6]>>>4:void 0}clone(){return new UUID(this.bytes.slice(0))}equals(other){return this.compareTo(other)===0}compareTo(other){for(let i=0;i<16;i++){let diff=this.bytes[i]-other.bytes[i];if(diff!==0)return Math.sign(diff)}return 0}},V7Generator=class{constructor(randomNumberGenerator){this.timestamp=0,this.counter=0,this.random=randomNumberGenerator??getDefaultRandom()}generate(){return this.generateOrResetCore(Date.now(),1e4)}generateOrAbort(){return this.generateOrAbortCore(Date.now(),1e4)}generateOrResetCore(unixTsMs,rollbackAllowance){let value=this.generateOrAbortCore(unixTsMs,rollbackAllowance);return value===void 0&&(this.timestamp=0,value=this.generateOrAbortCore(unixTsMs,rollbackAllowance)),value}generateOrAbortCore(unixTsMs,rollbackAllowance){if(!Number.isInteger(unixTsMs)||unixTsMs<1||unixTsMs>0xffffffffffff)throw new RangeError("`unixTsMs` must be a 48-bit positive integer");if(rollbackAllowance<0||rollbackAllowance>0xffffffffffff)throw new RangeError("`rollbackAllowance` out of reasonable range");if(unixTsMs>this.timestamp)this.timestamp=unixTsMs,this.resetCounter();else if(unixTsMs+rollbackAllowance>=this.timestamp)this.counter++,this.counter>4398046511103&&(this.timestamp++,this.resetCounter());else return;return UUID.fromFieldsV7(this.timestamp,Math.trunc(this.counter/2**30),this.counter&2**30-1,this.random.nextUint32())}resetCounter(){this.counter=this.random.nextUint32()*1024+(this.random.nextUint32()&1023)}generateV4(){let bytes=new Uint8Array(Uint32Array.of(this.random.nextUint32(),this.random.nextUint32(),this.random.nextUint32(),this.random.nextUint32()).buffer);return bytes[6]=64|bytes[6]>>>4,bytes[8]=128|bytes[8]>>>2,UUID.ofInner(bytes)}},getDefaultRandom=()=>{if(typeof crypto<"u"&&typeof crypto.getRandomValues<"u")return new BufferedCryptoRandom;if(typeof UUIDV7_DENY_WEAK_RNG<"u"&&UUIDV7_DENY_WEAK_RNG)throw new Error("no cryptographically strong RNG available");return{nextUint32:()=>Math.trunc(Math.random()*65536)*65536+Math.trunc(Math.random()*65536)}},BufferedCryptoRandom=class{constructor(){this.buffer=new Uint32Array(8),this.cursor=65535}nextUint32(){return this.cursor>=this.buffer.length&&(crypto.getRandomValues(this.buffer),this.cursor=0),this.buffer[this.cursor++]}},defaultGenerator;var uuidv7obj=()=>(defaultGenerator||(defaultGenerator=new V7Generator)).generate();var uuidv4obj=()=>(defaultGenerator||(defaultGenerator=new V7Generator)).generateV4();var __defProp=Object.defineProperty,__export=(target,all)=>{for(var name in all)__defProp(target,name,{get:all[name],enumerable:!0})};var Gap=class{args=[];constructor(...args){this.args=args}fill(value){return[this,value]}hasDefault(){return this.args.length===1}get default(){return this.args[0]}},cbor_exports={};__export(cbor_exports,{CborBreak:()=>CborBreak,CborError:()=>CborError,CborFillMissing:()=>CborFillMissing,CborInvalidMajorError:()=>CborInvalidMajorError,CborNumberError:()=>CborNumberError,CborPartialDisabled:()=>CborPartialDisabled,CborRangeError:()=>CborRangeError,Encoded:()=>Encoded,Gap:()=>Gap,POW_2_53:()=>POW_2_53,POW_2_64:()=>POW_2_64,PartiallyEncoded:()=>PartiallyEncoded,Reader:()=>Reader,Tagged:()=>Tagged,Writer:()=>Writer,decode:()=>decode,encode:()=>encode,infiniteBytes:()=>infiniteBytes,partiallyEncodeObject:()=>partiallyEncodeObject});var POW_2_53=9007199254740992,POW_2_64=BigInt(18446744073709552e3),Encoded=class{constructor(encoded){this.encoded=encoded}},SurrealDbError=class extends Error{},NoActiveSocket=class extends SurrealDbError{name="NoActiveSocket";message="No socket is currently connected to a SurrealDB instance. Please call the .connect() method first!"};var UnexpectedConnectionError=class extends SurrealDbError{constructor(error){super(),this.error=error,this.message=`${error}`}name="UnexpectedConnectionError"};var ConnectionUnavailable=class extends SurrealDbError{name="ConnectionUnavailable";message="There is no connection available at this moment."};var ResponseError=class extends SurrealDbError{constructor(message){super(),this.message=message}name="ResponseError"},NoNamespaceSpecified=class extends SurrealDbError{name="NoNamespaceSpecified";message="Please specify a namespace to use."},NoDatabaseSpecified=class extends SurrealDbError{name="NoDatabaseSpecified";message="Please specify a database to use."},NoTokenReturned=class extends SurrealDbError{name="NoTokenReturned";message="Did not receive an authentication token."};var CborError=class extends SurrealDbError{message;constructor(message){super(),this.message=message}},CborNumberError=class extends CborError{name="CborNumberError"},CborRangeError=class extends CborError{name="CborRangeError"},CborInvalidMajorError=class extends CborError{name="CborInvalidMajorError"},CborBreak=class extends CborError{name="CborBreak";constructor(){super("Came across a break which was not intercepted by the decoder")}},CborPartialDisabled=class extends CborError{name="CborPartialDisabled";constructor(){super("Tried to insert a Gap into a CBOR value, while partial mode is not enabled")}},CborFillMissing=class extends CborError{name="CborFillMissing";constructor(){super("Fill for a gap is missing, and gap has no default")}},Writer=class{constructor(byteLength=256){this.byteLength=byteLength,this._buf=new ArrayBuffer(this.byteLength),this._view=new DataView(this._buf),this._byte=new Uint8Array(this._buf)}_chunks=[];_pos=0;_buf;_view;_byte;chunk(gap){this._chunks.push([this._buf.slice(0,this._pos),gap]),this._buf=new ArrayBuffer(this.byteLength),this._view=new DataView(this._buf),this._byte=new Uint8Array(this._buf),this._pos=0}get chunks(){return this._chunks}get buffer(){return this._buf.slice(0,this._pos)}claim(length){let pos=this._pos;if(this._pos+=length,this._pos<=this._buf.byteLength)return pos;let newLen=this._buf.byteLength<<1;for(;newLen<this._pos;)newLen<<=1;if(newLen>this._buf.byteLength){let oldb=this._byte;this._buf=new ArrayBuffer(newLen),this._view=new DataView(this._buf),this._byte=new Uint8Array(this._buf),this._byte.set(oldb)}return pos}writeUint8(value){let pos=this.claim(1);this._view.setUint8(pos,value)}writeUint16(value){let pos=this.claim(2);this._view.setUint16(pos,value)}writeUint32(value){let pos=this.claim(4);this._view.setUint32(pos,value)}writeUint64(value){let pos=this.claim(8);this._view.setBigUint64(pos,value)}writeUint8Array(data){if(data.byteLength===0)return;let pos=this.claim(data.byteLength);this._byte.set(data,pos)}writeArrayBuffer(data){data.byteLength!==0&&this.writeUint8Array(new Uint8Array(data))}writePartiallyEncoded(data){for(let[buf,gap]of data.chunks)this.writeArrayBuffer(buf),this.chunk(gap);this.writeArrayBuffer(data.end)}writeFloat32(value){let pos=this.claim(4);this._view.setFloat32(pos,value)}writeFloat64(value){let pos=this.claim(8);this._view.setFloat64(pos,value)}writeMajor(type,length){let base=type<<5;length<24?this.writeUint8(base+Number(length)):length<256?(this.writeUint8(base+24),this.writeUint8(Number(length))):length<65536?(this.writeUint8(base+25),this.writeUint16(Number(length))):length<4294967296?(this.writeUint8(base+26),this.writeUint32(Number(length))):(this.writeUint8(base+27),this.writeUint64(BigInt(length)))}output(partial,replacer2){return partial?new PartiallyEncoded(this._chunks,this.buffer,replacer2):this.buffer}},PartiallyEncoded=class{constructor(chunks,end,replacer2){this.chunks=chunks,this.end=end,this.replacer=replacer2}build(fills,partial){let writer=new Writer,map=new Map(fills);for(let[buffer,gap]of this.chunks){let hasValue=map.has(gap)||gap.hasDefault();if(!partial&&!hasValue)throw new CborFillMissing;if(writer.writeArrayBuffer(buffer),hasValue){let data=map.get(gap)??gap.default;encode(data,{writer,replacer:this.replacer})}else writer.chunk(gap)}return writer.writeArrayBuffer(this.end),writer.output(!!partial,this.replacer)}};function partiallyEncodeObject(object,options){return Object.fromEntries(Object.entries(object).map(([k,v])=>[k,encode(v,{...options,partial:!0})]))}var Tagged=class{constructor(tag,value){this.tag=tag,this.value=value}},textEncoder;function encode(input,options={}){let w=options.writer??new Writer,fillsMap=new Map(options.fills??[]);function inner(input2){let value=options.replacer?options.replacer(input2):input2;if(value===void 0)return w.writeUint8(247);if(value===null)return w.writeUint8(246);if(value===!0)return w.writeUint8(245);if(value===!1)return w.writeUint8(244);switch(typeof value){case"number":{if(Number.isInteger(value))if(value>=0&&value<=9007199254740992)w.writeMajor(0,value);else if(value<0&&value>=-9007199254740992)w.writeMajor(1,-(value+1));else throw new CborNumberError("Number too big to be encoded");else w.writeUint8(251),w.writeFloat64(value);return}case"bigint":{if(value>=0&&value<POW_2_64)w.writeMajor(0,value);else if(value<=0&&value>=-POW_2_64)w.writeMajor(1,-(value+1n));else throw new CborNumberError("BigInt too big to be encoded");return}case"string":{textEncoder??=new TextEncoder;let encoded=textEncoder.encode(value);w.writeMajor(3,encoded.byteLength),w.writeUint8Array(encoded);return}default:{if(Array.isArray(value)){w.writeMajor(4,value.length);for(let v of value)inner(v);return}if(value instanceof Tagged){w.writeMajor(6,value.tag),inner(value.value);return}if(value instanceof Encoded){w.writeArrayBuffer(value.encoded);return}if(value instanceof Gap){if(fillsMap.has(value))inner(fillsMap.get(value));else{if(!options.partial)throw new CborPartialDisabled;w.chunk(value)}return}if(value instanceof PartiallyEncoded){let res=value.build(options.fills??[],options.partial);options.partial?w.writePartiallyEncoded(res):w.writeArrayBuffer(res);return}if(value instanceof Uint8Array||value instanceof Uint16Array||value instanceof Uint32Array||value instanceof Int8Array||value instanceof Int16Array||value instanceof Int32Array||value instanceof Float32Array||value instanceof Float64Array||value instanceof ArrayBuffer){let v=new Uint8Array(value);w.writeMajor(2,v.byteLength),w.writeUint8Array(v);return}let entries=value instanceof Map?Array.from(value.entries()):Object.entries(value);w.writeMajor(5,entries.length);for(let v of entries.flat())inner(v)}}}return inner(input),w.output(!!options.partial,options.replacer)}var Reader=class{_buf;_view;_byte;_pos=0;constructor(buffer){this._buf=new ArrayBuffer(buffer.byteLength),this._view=new DataView(this._buf),this._byte=new Uint8Array(this._buf),this._byte.set(new Uint8Array(buffer))}read(amount,res){return this._pos+=amount,res}readUint8(){try{return this.read(1,this._view.getUint8(this._pos))}catch(e){throw e instanceof RangeError?new CborRangeError(e.message):e}}readUint16(){try{return this.read(2,this._view.getUint16(this._pos))}catch(e){throw e instanceof RangeError?new CborRangeError(e.message):e}}readUint32(){try{return this.read(4,this._view.getUint32(this._pos))}catch(e){throw e instanceof RangeError?new CborRangeError(e.message):e}}readUint64(){try{return this.read(8,this._view.getBigUint64(this._pos))}catch(e){throw e instanceof RangeError?new CborRangeError(e.message):e}}readFloat16(){let bytes=this.readUint16(),s2=(bytes&32768)>>15,e=(bytes&31744)>>10,f2=bytes&1023;return e===0?(s2?-1:1)*2**-14*(f2/2**10):e===31?f2?Number.NaN:(s2?-1:1)*Number.POSITIVE_INFINITY:(s2?-1:1)*2**(e-15)*(1+f2/2**10)}readFloat32(){try{return this.read(4,this._view.getFloat32(this._pos))}catch(e){throw e instanceof RangeError?new CborRangeError(e.message):e}}readFloat64(){try{return this.read(8,this._view.getFloat64(this._pos))}catch(e){throw e instanceof RangeError?new CborRangeError(e.message):e}}readBytes(amount){let available=this._byte.length-this._pos;if(available<amount)throw new CborRangeError(`The argument must be between 0 and ${available}`);return this.read(amount,this._byte.slice(this._pos,this._pos+amount))}readMajor(){let byte=this.readUint8(),major=byte>>5;if(major<0||major>7)throw new CborInvalidMajorError("Received invalid major type");return[major,byte&31]}readMajorLength(length){if(length<=23)return length;switch(length){case 24:return this.readUint8();case 25:return this.readUint16();case 26:return this.readUint32();case 27:{let read=this.readUint64();return read>9007199254740992?read:Number(read)}}throw new CborRangeError("Expected a final length")}};function infiniteBytes(r2,forMajor){let w=new Writer;for(;;){let[major,len]=r2.readMajor();if(major===7&&len===31)break;if(major!==forMajor)throw new CborInvalidMajorError(`Expected a resource of the same major (${forMajor}) while processing an infinite resource`);if(len===31)throw new CborRangeError("Expected a finite resource while processing an infinite resource");w.writeUint8Array(r2.readBytes(Number(r2.readMajorLength(len))))}return w.buffer}var textDecoder;function decode(input,options={}){let r2=input instanceof Reader?input:new Reader(input);function inner(){let[major,len]=r2.readMajor();switch(major){case 0:return r2.readMajorLength(len);case 1:{let l=r2.readMajorLength(len);return typeof l=="bigint"?-(l+1n):-(l+1)}case 2:return len===31?infiniteBytes(r2,2):r2.readBytes(Number(r2.readMajorLength(len))).buffer;case 3:{let encoded=len===31?infiniteBytes(r2,3):r2.readBytes(Number(r2.readMajorLength(len)));return textDecoder??=new TextDecoder,textDecoder.decode(encoded)}case 4:{if(len===31){let arr2=[];for(;;)try{arr2.push(decode2())}catch(e){if(e instanceof CborBreak)break;throw e}return arr2}let l=r2.readMajorLength(len),arr=Array(l);for(let i=0;i<l;i++)arr[i]=decode2();return arr}case 5:{let entries=[];if(len===31)for(;;){let key;try{key=decode2()}catch(e){if(e instanceof CborBreak)break;throw e}let value=decode2();entries.push([key,value])}else{let l=r2.readMajorLength(len);for(let i=0;i<l;i++){let key=decode2(),value=decode2();entries[i]=[key,value]}}return options.map==="map"?new Map(entries):Object.fromEntries(entries)}case 6:{let tag=r2.readMajorLength(len),value=decode2();return new Tagged(tag,value)}case 7:switch(len){case 20:return!1;case 21:return!0;case 22:return null;case 23:return;case 25:return r2.readFloat16();case 26:return r2.readFloat32();case 27:return r2.readFloat64();case 31:throw new CborBreak}}throw new CborInvalidMajorError(`Unable to decode value with major tag ${major}`)}function decode2(){return options.replacer?options.replacer(inner()):inner()}return decode2()}function dateToCborCustomDate(date){let s2=Math.floor(date.getTime()/1e3),ms=date.getTime()-s2*1e3;return[s2,ms*1e6]}function cborCustomDateToDate([s2,ns]){let date=new Date(0);return date.setUTCSeconds(Number(s2)),date.setMilliseconds(Math.floor(Number(ns)/1e6)),date}var Value=class{},Decimal=class _Decimal extends Value{decimal;constructor(decimal){super(),this.decimal=decimal.toString()}equals(other){return other instanceof _Decimal?this.decimal===other.decimal:!1}toString(){return this.decimal}toJSON(){return this.decimal}},millisecond=1,microsecond=millisecond/1e3,nanosecond=microsecond/1e3,second=1e3*millisecond,minute=60*second,hour=60*minute,day=24*hour,week=7*day,units=new Map([["ns",nanosecond],["\xB5s",microsecond],["\u03BCs",microsecond],["us",microsecond],["ms",millisecond],["s",second],["m",minute],["h",hour],["d",day],["w",week]]),unitsReverse=Array.from(units).reduce((map,[unit,size])=>(map.set(size,unit),map),new Map),durationPartRegex=new RegExp(`^(\\d+)(${Array.from(units.keys()).join("|")})`),Duration=class _Duration extends Value{_milliseconds;constructor(input){super(),input instanceof _Duration?this._milliseconds=input._milliseconds:typeof input=="string"?this._milliseconds=_Duration.parseString(input):this._milliseconds=input}static fromCompact([s2,ns]){s2=s2??0,ns=ns??0;let ms=s2*1e3+ns/1e6;return new _Duration(ms)}equals(other){return other instanceof _Duration?this._milliseconds===other._milliseconds:!1}toCompact(){let s2=Math.floor(this._milliseconds/1e3),ns=Math.floor((this._milliseconds-s2*1e3)*1e6);return ns>0?[s2,ns]:s2>0?[s2]:[]}toString(){let left=this._milliseconds,result="";function scrap(size){let num=Math.floor(left/size);return num>0&&(left=left%size),num}for(let[size,unit]of Array.from(unitsReverse).reverse()){let scrapped=scrap(size);scrapped>0&&(result+=`${scrapped}${unit}`)}return result}toJSON(){return this.toString()}static parseString(input){let ms=0,left=input;for(;left!=="";){let match=left.match(durationPartRegex);if(match){let amount=Number.parseInt(match[1]),factor=units.get(match[2]);if(factor===void 0)throw new SurrealDbError(`Invalid duration unit: ${match[2]}`);ms+=amount*factor,left=left.slice(match[0].length);continue}throw new SurrealDbError("Could not match a next duration part")}return ms}static nanoseconds(nanoseconds){return new _Duration(Math.floor(nanoseconds*nanosecond))}static microseconds(microseconds){return new _Duration(Math.floor(microseconds*microsecond))}static milliseconds(milliseconds){return new _Duration(milliseconds)}static seconds(seconds){return new _Duration(seconds*second)}static minutes(minutes){return new _Duration(minutes*minute)}static hours(hours){return new _Duration(hours*hour)}static days(days){return new _Duration(days*day)}static weeks(weeks){return new _Duration(weeks*week)}get microseconds(){return Math.floor(this._milliseconds/microsecond)}get nanoseconds(){return Math.floor(this._milliseconds/nanosecond)}get milliseconds(){return Math.floor(this._milliseconds)}get seconds(){return Math.floor(this._milliseconds/second)}get minutes(){return Math.floor(this._milliseconds/minute)}get hours(){return Math.floor(this._milliseconds/hour)}get days(){return Math.floor(this._milliseconds/day)}get weeks(){return Math.floor(this._milliseconds/week)}},Future=class _Future extends Value{constructor(inner){super(),this.inner=inner}equals(other){return other instanceof _Future?this.inner===other.inner:!1}toJSON(){return this.toString()}toString(){return`<future> ${this.inner}`}},Geometry=class _Geometry extends Value{equals(other){return other instanceof _Geometry?this.is(other):!1}toString(){return JSON.stringify(this.toJSON())}};function f(num){return num instanceof Decimal?Number.parseFloat(num.decimal):num}var GeometryPoint=class _GeometryPoint extends Geometry{point;constructor(point){super(),point instanceof _GeometryPoint?this.point=point.clone().point:this.point=[f(point[0]),f(point[1])]}toJSON(){return{type:"Point",coordinates:this.coordinates}}get coordinates(){return this.point}is(geometry){return geometry instanceof _GeometryPoint?this.point[0]===geometry.point[0]&&this.point[1]===geometry.point[1]:!1}clone(){return new _GeometryPoint([...this.point])}},GeometryLine=class _GeometryLine extends Geometry{line;constructor(line){super(),this.line=line instanceof _GeometryLine?line.clone().line:line}toJSON(){return{type:"LineString",coordinates:this.coordinates}}get coordinates(){return this.line.map(g=>g.coordinates)}close(){this.line[0].is(this.line.at(-1))||this.line.push(this.line[0])}is(geometry){if(!(geometry instanceof _GeometryLine)||this.line.length!==geometry.line.length)return!1;for(let i=0;i<this.line.length;i++)if(!this.line[i].is(geometry.line[i]))return!1;return!0}clone(){return new _GeometryLine(this.line.map(p=>p.clone()))}},GeometryPolygon=class _GeometryPolygon extends Geometry{polygon;constructor(polygon){super(),this.polygon=polygon instanceof _GeometryPolygon?polygon.clone().polygon:polygon.map(l=>{let line=l.clone();return line.close(),line})}toJSON(){return{type:"Polygon",coordinates:this.coordinates}}get coordinates(){return this.polygon.map(g=>g.coordinates)}is(geometry){if(!(geometry instanceof _GeometryPolygon)||this.polygon.length!==geometry.polygon.length)return!1;for(let i=0;i<this.polygon.length;i++)if(!this.polygon[i].is(geometry.polygon[i]))return!1;return!0}clone(){return new _GeometryPolygon(this.polygon.map(p=>p.clone()))}},GeometryMultiPoint=class _GeometryMultiPoint extends Geometry{points;constructor(points){super(),this.points=points instanceof _GeometryMultiPoint?points.points:points}toJSON(){return{type:"MultiPoint",coordinates:this.coordinates}}get coordinates(){return this.points.map(g=>g.coordinates)}is(geometry){if(!(geometry instanceof _GeometryMultiPoint)||this.points.length!==geometry.points.length)return!1;for(let i=0;i<this.points.length;i++)if(!this.points[i].is(geometry.points[i]))return!1;return!0}clone(){return new _GeometryMultiPoint(this.points.map(p=>p.clone()))}},GeometryMultiLine=class _GeometryMultiLine extends Geometry{lines;constructor(lines){super(),this.lines=lines instanceof _GeometryMultiLine?lines.lines:lines}toJSON(){return{type:"MultiLineString",coordinates:this.coordinates}}get coordinates(){return this.lines.map(g=>g.coordinates)}is(geometry){if(!(geometry instanceof _GeometryMultiLine)||this.lines.length!==geometry.lines.length)return!1;for(let i=0;i<this.lines.length;i++)if(!this.lines[i].is(geometry.lines[i]))return!1;return!0}clone(){return new _GeometryMultiLine(this.lines.map(p=>p.clone()))}},GeometryMultiPolygon=class _GeometryMultiPolygon extends Geometry{polygons;constructor(polygons){super(),this.polygons=polygons instanceof _GeometryMultiPolygon?polygons.polygons:polygons}toJSON(){return{type:"MultiPolygon",coordinates:this.coordinates}}get coordinates(){return this.polygons.map(g=>g.coordinates)}is(geometry){if(!(geometry instanceof _GeometryMultiPolygon)||this.polygons.length!==geometry.polygons.length)return!1;for(let i=0;i<this.polygons.length;i++)if(!this.polygons[i].is(geometry.polygons[i]))return!1;return!0}clone(){return new _GeometryMultiPolygon(this.polygons.map(p=>p.clone()))}},GeometryCollection=class _GeometryCollection extends Geometry{collection;constructor(collection){super(),this.collection=collection instanceof _GeometryCollection?collection.collection:collection}toJSON(){return{type:"GeometryCollection",geometries:this.geometries}}get geometries(){return this.collection.map(g=>g.toJSON())}is(geometry){if(!(geometry instanceof _GeometryCollection)||this.collection.length!==geometry.collection.length)return!1;for(let i=0;i<this.collection.length;i++)if(!this.collection[i].is(geometry.collection[i]))return!1;return!0}clone(){return new _GeometryCollection(this.collection.map(p=>p.clone()))}};function equals(x,y){if(Object.is(x,y))return!0;if(x instanceof Date&&y instanceof Date)return x.getTime()===y.getTime();if(x instanceof RegExp&&y instanceof RegExp)return x.toString()===y.toString();if(x instanceof Value&&y instanceof Value)return x.equals(y);if(typeof x!="object"||x===null||typeof y!="object"||y===null)return!1;let keysX=Reflect.ownKeys(x),keysY=Reflect.ownKeys(y);if(keysX.length!==keysY.length)return!1;for(let i=0;i<keysX.length;i++)if(!Reflect.has(y,keysX[i])||!equals(x[keysX[i]],y[keysX[i]]))return!1;return!0}var MAX_i64=9223372036854775807n;function escapeIdent(str){if(isOnlyNumbers(str))return`\u27E8${str}\u27E9`;if(str==="")return"\u27E8\u27E9";let code,i,len;for(i=0,len=str.length;i<len;i++)if(code=str.charCodeAt(i),!(code>47&&code<58)&&!(code>64&&code<91)&&!(code>96&&code<123)&&code!==95)return`\u27E8${str.replaceAll("\u27E9","\\\u27E9")}\u27E9`;return str}function escapeNumber(num){return num<=MAX_i64?num.toString():`\u27E8${num}\u27E9`}function isOnlyNumbers(str){return/^\d+$/.test(str.replace(/_/g,""))}var Uuid=class _Uuid extends Value{inner;constructor(uuid){super(),uuid instanceof ArrayBuffer?this.inner=UUID.ofInner(new Uint8Array(uuid)):uuid instanceof Uint8Array?this.inner=UUID.ofInner(uuid):uuid instanceof _Uuid?this.inner=uuid.inner:uuid instanceof UUID?this.inner=uuid:this.inner=UUID.parse(uuid)}equals(other){return other instanceof _Uuid?this.inner.equals(other.inner):!1}toString(){return this.inner.toString()}toJSON(){return this.inner.toString()}toUint8Array(){return this.inner.bytes}toBuffer(){return this.inner.bytes.buffer}static v4(){return new _Uuid(uuidv4obj())}static v7(){return new _Uuid(uuidv7obj())}},RecordId=class _RecordId extends Value{tb;id;constructor(tb,id2){if(super(),typeof tb!="string")throw new SurrealDbError("TB part is not valid");if(!isValidIdPart(id2))throw new SurrealDbError("ID part is not valid");this.tb=tb,this.id=id2}equals(other){return other instanceof _RecordId?this.tb===other.tb&&equals(this.id,other.id):!1}toJSON(){return this.toString()}toString(){let tb=escapeIdent(this.tb),id2=escapeIdPart(this.id);return`${tb}:${id2}`}},StringRecordId=class _StringRecordId extends Value{rid;constructor(rid){if(super(),rid instanceof _StringRecordId)this.rid=rid.rid;else if(rid instanceof RecordId)this.rid=rid.toString();else if(typeof rid=="string")this.rid=rid;else throw new SurrealDbError("String Record ID must be a string")}equals(other){return other instanceof _StringRecordId?this.rid===other.rid:!1}toJSON(){return this.rid}toString(){return this.rid}};function isValidIdPart(v){if(v instanceof Uuid)return!0;switch(typeof v){case"string":case"number":case"bigint":return!0;case"object":return Array.isArray(v)||v!==null;default:return!1}}function escapeIdPart(id2){return id2 instanceof Uuid?`u"${id2}"`:typeof id2=="string"?escapeIdent(id2):typeof id2=="bigint"||typeof id2=="number"?escapeNumber(id2):toSurrealqlString(id2)}var Table=class _Table extends Value{tb;constructor(tb){if(super(),typeof tb!="string")throw new SurrealDbError("Table must be a string");this.tb=tb}equals(other){return other instanceof _Table?this.tb===other.tb:!1}toJSON(){return this.tb}toString(){return this.tb}};function toSurrealqlString(input){if(typeof input=="string")return`s${JSON.stringify(input)}`;if(input===null)return"NULL";if(input===void 0)return"NONE";if(typeof input=="object"){if(input instanceof Date)return`d${JSON.stringify(input.toISOString())}`;if(input instanceof Uuid)return`u${JSON.stringify(input.toString())}`;if(input instanceof RecordId||input instanceof StringRecordId)return`r${JSON.stringify(input.toString())}`;if(input instanceof Geometry)return toSurrealqlString(input.toJSON());if(input instanceof Decimal||input instanceof Duration||input instanceof Future||input instanceof Range||input instanceof Table)return input.toJSON();switch(Object.getPrototypeOf(input)){case Object.prototype:{let output2="{ ",entries=Object.entries(input);for(let[i,[k,v]]of entries.entries())output2+=`${JSON.stringify(k)}: ${toSurrealqlString(v)}`,i<entries.length-1&&(output2+=", ");return output2+=" }",output2}case Map.prototype:{let output2="{ ",entries=Array.from(input.entries());for(let[i,[k,v]]of entries.entries())output2+=`${JSON.stringify(k)}: ${toSurrealqlString(v)}`,i<entries.length-1&&(output2+=", ");return output2+=" }",output2}case Array.prototype:return`[ ${input.map(toSurrealqlString).join(", ")} ]`;case Set.prototype:return`[ ${[...new Set([...input].map(toSurrealqlString))].join(", ")} ]`}}return`${input}`}var Range=class _Range extends Value{constructor(beg,end){super(),this.beg=beg,this.end=end}equals(other){return!(other instanceof _Range)||this.beg?.constructor!==other.beg?.constructor||this.end?.constructor!==other.end?.constructor?!1:equals(this.beg?.value,other.beg?.value)&&equals(this.end?.value,other.end?.value)}toJSON(){return this.toString()}toString(){let beg=escapeRangeBound(this.beg),end=escapeRangeBound(this.end);return`${beg}${getRangeJoin(this.beg,this.end)}${end}`}},BoundIncluded=class{constructor(value){this.value=value}},BoundExcluded=class{constructor(value){this.value=value}},RecordIdRange=class _RecordIdRange extends Value{constructor(tb,beg,end){if(super(),this.tb=tb,this.beg=beg,this.end=end,typeof tb!="string")throw new SurrealDbError("TB part is not valid");if(!isValidIdBound(beg))throw new SurrealDbError("Beg part is not valid");if(!isValidIdBound(end))throw new SurrealDbError("End part is not valid")}equals(other){return!(other instanceof _RecordIdRange)||this.beg?.constructor!==other.beg?.constructor||this.end?.constructor!==other.end?.constructor?!1:this.tb===other.tb&&equals(this.beg?.value,other.beg?.value)&&equals(this.end?.value,other.end?.value)}toJSON(){return this.toString()}toString(){let tb=escapeIdent(this.tb),beg=escapeIdBound(this.beg),end=escapeIdBound(this.end);return`${tb}:${beg}${getRangeJoin(this.beg,this.end)}${end}`}};function getRangeJoin(beg,end){let output2="";return beg instanceof BoundExcluded&&(output2+=">"),output2+="..",end instanceof BoundIncluded&&(output2+="="),output2}function isValidIdBound(bound){return bound instanceof BoundIncluded||bound instanceof BoundExcluded?isValidIdPart(bound.value):!0}function escapeIdBound(bound){return bound instanceof BoundIncluded||bound instanceof BoundExcluded?escapeIdPart(bound.value):""}function escapeRangeBound(bound){if(bound===void 0)return"";let value=bound.value;return bound instanceof Range?`(${toSurrealqlString(value)})`:toSurrealqlString(value)}function rangeToCbor([beg,end]){function encodeBound(bound){return bound instanceof BoundIncluded?new Tagged(TAG_BOUND_INCLUDED,bound.value):bound instanceof BoundExcluded?new Tagged(TAG_BOUND_EXCLUDED,bound.value):null}return[encodeBound(beg),encodeBound(end)]}function cborToRange(range){function decodeBound(bound){if(bound!==null){if(bound.tag===TAG_BOUND_INCLUDED)return new BoundIncluded(bound.value);if(bound.tag===TAG_BOUND_EXCLUDED)return new BoundExcluded(bound.value);throw new SurrealDbError("Invalid bound tag")}}return[decodeBound(range[0]),decodeBound(range[1])]}var TAG_SPEC_DATETIME=0,TAG_SPEC_UUID=37,TAG_NONE=6,TAG_TABLE=7,TAG_RECORDID=8,TAG_STRING_UUID=9,TAG_STRING_DECIMAL=10,TAG_CUSTOM_DATETIME=12,TAG_STRING_DURATION=13,TAG_CUSTOM_DURATION=14,TAG_FUTURE=15,TAG_RANGE=49,TAG_BOUND_INCLUDED=50,TAG_BOUND_EXCLUDED=51,TAG_GEOMETRY_POINT=88,TAG_GEOMETRY_LINE=89,TAG_GEOMETRY_POLYGON=90,TAG_GEOMETRY_MULTIPOINT=91,TAG_GEOMETRY_MULTILINE=92,TAG_GEOMETRY_MULTIPOLYGON=93,TAG_GEOMETRY_COLLECTION=94,replacer={encode(v){return v instanceof Date?new Tagged(TAG_CUSTOM_DATETIME,dateToCborCustomDate(v)):v===void 0?new Tagged(TAG_NONE,null):v instanceof Uuid?new Tagged(TAG_SPEC_UUID,v.toBuffer()):v instanceof Decimal?new Tagged(TAG_STRING_DECIMAL,v.toString()):v instanceof Duration?new Tagged(TAG_CUSTOM_DURATION,v.toCompact()):v instanceof RecordId?new Tagged(TAG_RECORDID,[v.tb,v.id]):v instanceof StringRecordId?new Tagged(TAG_RECORDID,v.rid):v instanceof RecordIdRange?new Tagged(TAG_RECORDID,[v.tb,new Tagged(TAG_RANGE,rangeToCbor([v.beg,v.end]))]):v instanceof Table?new Tagged(TAG_TABLE,v.tb):v instanceof Future?new Tagged(TAG_FUTURE,v.inner):v instanceof Range?new Tagged(TAG_RANGE,rangeToCbor([v.beg,v.end])):v instanceof GeometryPoint?new Tagged(TAG_GEOMETRY_POINT,v.point):v instanceof GeometryLine?new Tagged(TAG_GEOMETRY_LINE,v.line):v instanceof GeometryPolygon?new Tagged(TAG_GEOMETRY_POLYGON,v.polygon):v instanceof GeometryMultiPoint?new Tagged(TAG_GEOMETRY_MULTIPOINT,v.points):v instanceof GeometryMultiLine?new Tagged(TAG_GEOMETRY_MULTILINE,v.lines):v instanceof GeometryMultiPolygon?new Tagged(TAG_GEOMETRY_MULTIPOLYGON,v.polygons):v instanceof GeometryCollection?new Tagged(TAG_GEOMETRY_COLLECTION,v.collection):v},decode(v){if(!(v instanceof Tagged))return v;switch(v.tag){case TAG_SPEC_DATETIME:return new Date(v.value);case TAG_SPEC_UUID:case TAG_STRING_UUID:return new Uuid(v.value);case TAG_CUSTOM_DATETIME:return cborCustomDateToDate(v.value);case TAG_NONE:return;case TAG_STRING_DECIMAL:return new Decimal(v.value);case TAG_STRING_DURATION:return new Duration(v.value);case TAG_CUSTOM_DURATION:return Duration.fromCompact(v.value);case TAG_TABLE:return new Table(v.value);case TAG_FUTURE:return new Future(v.value);case TAG_RANGE:return new Range(...cborToRange(v.value));case TAG_RECORDID:return v.value[1]instanceof Range?new RecordIdRange(v.value[0],v.value[1].beg,v.value[1].end):new RecordId(v.value[0],v.value[1]);case TAG_GEOMETRY_POINT:return new GeometryPoint(v.value);case TAG_GEOMETRY_LINE:return new GeometryLine(v.value);case TAG_GEOMETRY_POLYGON:return new GeometryPolygon(v.value);case TAG_GEOMETRY_MULTIPOINT:return new GeometryMultiPoint(v.value);case TAG_GEOMETRY_MULTILINE:return new GeometryMultiLine(v.value);case TAG_GEOMETRY_MULTIPOLYGON:return new GeometryMultiPolygon(v.value);case TAG_GEOMETRY_COLLECTION:return new GeometryCollection(v.value)}}};Object.freeze(replacer);function convertAuth(params){let result={},convertString=(a,b,optional)=>{if(a in params)result[b]=`${params[a]}`,delete result[a];else if(optional!==!0)throw new SurrealDbError(`Key ${a} is missing from the authentication parameters`)};return"scope"in params?(result={...params},convertString("scope","sc"),convertString("namespace","ns"),convertString("database","db")):"variables"in params?(result={...params.variables},convertString("access","ac"),convertString("namespace","ns"),convertString("database","db")):(convertString("access","ac",!0),convertString("database","db",!0),convertString("namespace","ns",!("database"in params)),convertString("username","user"),convertString("password","pass")),result}var supportedSurrealDbVersionMin="1.4.2",supportedSurrealDbVersionUntil="3.0.0",supportedSurrealDbVersionRange=`>= ${supportedSurrealDbVersionMin} < ${supportedSurrealDbVersionUntil}`;var id=0;function getIncrementalID(){return id=(id+1)%Number.MAX_SAFE_INTEGER,id.toString()}var RetryMessage=Symbol("RetryMessage"),ConnectionStatus=(ConnectionStatus2=>(ConnectionStatus2.Disconnected="disconnected",ConnectionStatus2.Connecting="connecting",ConnectionStatus2.Reconnecting="reconnecting",ConnectionStatus2.Connected="connected",ConnectionStatus2.Error="error",ConnectionStatus2))(ConnectionStatus||{});var AbstractEngine=class{context;ready;status="disconnected";connection={url:void 0,namespace:void 0,database:void 0,token:void 0};constructor(context){this.context=context}get emitter(){return this.context.emitter}get encodeCbor(){return this.context.encodeCbor}get decodeCbor(){return this.context.decodeCbor}};function processAuthVars(vars,fallback){if("scope"in vars||"access"in vars&&"variables"in vars&&vars.variables){if(!vars.namespace){if(!fallback?.namespace)throw new NoNamespaceSpecified;vars.namespace=fallback.namespace}if(!vars.database){if(!fallback?.database)throw new NoDatabaseSpecified;vars.database=fallback.database}}return vars}var AuthController=class{async signup(vars){if(!this.connection)throw new NoActiveSocket;let parsed=processAuthVars(vars,this.connection.connection),converted=convertAuth(parsed),res=await this.rpc("signup",[converted]);if(res.error)throw new ResponseError(res.error.message);if(!res.result)throw new NoTokenReturned;return res.result}async signin(vars){if(!this.connection)throw new NoActiveSocket;let parsed=processAuthVars(vars,this.connection.connection),converted=convertAuth(parsed),res=await this.rpc("signin",[converted]);if(res.error)throw new ResponseError(res.error.message);if(!res.result)throw new NoTokenReturned;return res.result}async authenticate(token){let res=await this.rpc("authenticate",[token]);if(res.error)throw new ResponseError(res.error.message);return!0}async invalidate(){let res=await this.rpc("invalidate");if(res.error)throw new ResponseError(res.error.message);return!0}},EngineAuth=class extends AuthController{constructor(connection){super(),this.connection=connection}rpc(method,params){if(!this.connection)throw new NoActiveSocket;return this.connection.rpc({method,params})}};function surrealdbWasmEngines(opts){class WasmEmbeddedEngine extends AbstractEngine{ready=void 0;reader;status=ConnectionStatus.Disconnected;queue=[];processing=!1;db;async version(){return SurrealWasmEngine.version()}setStatus(status,...args){this.status=status,this.emitter.emit(status,args)}async connect(url){this.connection.url=url,this.setStatus(ConnectionStatus.Connecting);let ready=(async()=>{let db=await SurrealWasmEngine.connect(url.toString(),opts).catch(e=>{console.log(e);let error=new UnexpectedConnectionError(typeof e=="string"?e:"error"in e?e.error:"An unexpected error occurred");throw this.setStatus(ConnectionStatus.Error,error),e});this.db=db,await this.context.prepare?.(new EngineAuth(this)),this.setStatus(ConnectionStatus.Connected),this.reader=(async()=>{let reader=db.notifications().getReader();for(;this.connected;){let{done,value}=await reader.read();if(done)break;let raw=value,{id:id2,action,result}=this.decodeCbor(raw.buffer);id2&&this.emitter.emit(`live-${id2.toString()}`,[action,result],!0)}})()})();return this.ready=ready,await ready}async disconnect(){this.connection={url:void 0,namespace:void 0,database:void 0,token:void 0},await this.ready,this.ready=void 0,this.db?.free(),this.db=void 0,await this.reader,this.reader=void 0,this.status!==ConnectionStatus.Disconnected&&this.setStatus(ConnectionStatus.Disconnected)}async rpc(request){if(await this.ready,!this.db)throw new ConnectionUnavailable;return new Promise((resolve,reject)=>{this.queue.push(async()=>{try{let result=await this.execute(request);resolve(result)}catch(error){reject(error)}}),this.processQueue()})}get connected(){return!!this.db}async processQueue(){if(!this.processing){for(this.processing=!0;this.queue.length>0;){let task=this.queue.shift();if(task)try{await task()}catch(error){console.error("Query execution failed",error)}}this.processing=!1}}async execute(request){let id2=getIncrementalID(),res=await this.db.execute(new Uint8Array(this.encodeCbor({id:id2,...request}))).then(raw=>({result:this.decodeCbor(raw.buffer)})).catch(message=>({error:{code:-1,message}}));if("result"in res)switch(request.method){case"use":{this.connection.namespace=request.params?.[0],this.connection.database=request.params?.[1];break}case"signin":case"signup":{this.connection.token=res.result;break}case"authenticate":{this.connection.token=request.params?.[0];break}case"invalidate":{this.connection.token=void 0;break}}return res}export(options){return this.db.export(options?new Uint8Array(this.encodeCbor(options)):void 0)}import(input){return this.db.import(input)}}return{mem:WasmEmbeddedEngine,indxdb:WasmEmbeddedEngine}}export{surrealdbWasmEngines};
/*! Bundled license information:

uuidv7/dist/index.js:
  (**
   * uuidv7: A JavaScript implementation of UUID version 7
   *
   * @license Apache-2.0
   * @copyright 2021-2024 LiosK
   * @packageDocumentation
   *)
*/
